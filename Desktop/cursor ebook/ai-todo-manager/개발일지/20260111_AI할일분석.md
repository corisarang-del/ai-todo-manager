# AI 할 일 분석 및 요약 기능 구현

**작성시각**: 2026-01-11 20:14

## 해결하고자 한 문제

사용자의 할 일 목록을 AI로 분석하여 요약, 긴급 작업, 인사이트, 추천사항을 제공하는 기능 구현

## 해결된 것

### 1. 백엔드 API Route (`app/api/analyze-todos/route.ts`)

✅ **통계 계산**
- 전체 할 일 개수
- 완료율 계산
- 우선순위별 분포
- 카테고리별 분포
- 마감일 지난 할 일
- 시간대별 분포 (오전/오후/저녁)

✅ **Gemini API 연동**
```typescript
const { object } = await generateObject({
  model: google('gemini-2.0-flash-exp', { apiKey }),
  schema: analysisSchema,
  prompt: `...`
});
```

✅ **분석 결과 스키마**
```typescript
{
  summary: string,           // 전체 요약
  urgentTasks: string[],     // 긴급 작업 목록
  insights: string[],        // 인사이트 3-5개
  recommendations: string[]  // 추천사항 3-5개
}
```

### 2. 프론트엔드 컴포넌트 (`components/todo/AiSummary.tsx`)

✅ **탭 UI**
- "오늘의 요약" 탭
- "이번 주 요약" 탭

✅ **날짜 필터링**
```typescript
const getTodayTodos = () => {
  const today = new Date().toISOString().slice(0, 10);
  return todos.filter((t) => t.due_date?.startsWith(today));
};

const getWeekTodos = () => {
  // 이번 주 일요일 ~ 토요일
  return todos.filter((t) => {
    const dueDate = new Date(t.due_date);
    return dueDate >= weekStart && dueDate <= weekEnd;
  });
};
```

✅ **AI 요약 버튼**
- Sparkles 아이콘
- 로딩 스피너 (Loader2)
- 비활성화 상태

✅ **분석 결과 표시**
- 전체 요약 (그라데이션 카드)
- 긴급 작업 (빨간 배지)
- 인사이트 (💡 아이콘)
- 추천사항 (✅ 아이콘)

### 3. 메인 페이지 통합 (`app/page.tsx`)

✅ **AiSummary 컴포넌트 추가**
```tsx
<AiSummary todos={todos} />
```

✅ **배치**
- 검색/필터 섹션 아래
- TodoForm/TodoList 위

## 해결되지 않은 것

없음 - 모든 기능이 정상 작동함

## 테스트 결과

### 오늘의 요약 테스트
- ✅ "AI 요약" 버튼 클릭
- ✅ 로딩 스피너 표시
- ✅ 분석 결과 표시
  - 전체 요약
  - 긴급 작업
  - 인사이트
  - 추천사항

### 이번 주 요약 테스트
- ✅ "이번 주 요약" 탭 선택
- ✅ "AI 요약" 버튼 클릭
- ✅ 이번 주 전체 할 일 분석

### 다양한 시나리오
- ✅ 할 일이 없을 때 → 적절한 메시지
- ✅ 모두 완료했을 때 → 격려 메시지
- ✅ 긴급 작업이 많을 때 → 우선순위 추천
- ✅ 마감일 지난 작업 → 재조정 권장

## 향후 개발을 위한 컨텍스트 정리

### API 흐름
1. 사용자가 "AI 요약" 버튼 클릭
2. 프론트엔드에서 필터링된 할 일 목록 전송
3. 백엔드에서 통계 계산
4. Gemini API로 분석
5. 분석 결과 반환
6. 프론트엔드에서 결과 표시

### 프롬프트 설계
- 한국어, 친근한 반말 톤
- 데이터 기반 인사이트
- 실행 가능한 구체적 추천
- 격려하는 메시지

### 개선 가능 사항
- 분석 결과 캐싱
- 주간/월간 트렌드 분석
- 생산성 점수 계산
- 목표 달성률 추적
