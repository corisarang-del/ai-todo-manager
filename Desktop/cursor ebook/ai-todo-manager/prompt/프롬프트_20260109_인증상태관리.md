# 프롬프트 - Supabase 인증 상태 관리 기능 추가

**작성 시각**: 2026-01-09 15:02:50

## 요청 내용

Supabase 인증 상태를 관리하는 기능을 추가

### 1. 필요한 기능
- **비로그인 사용자 리다이렉트**
  - 로그인하지 않은 사용자가 메인페이지(/)에 접근하면 자동으로 로그인(/login)페이지로 리다이렉트

- **로그인된 사용자 리다이렉트**
  - 로그인된 사용자가 로그인 페이지에 접근하면 자동으로 메인 페이지로 리다이렉트
  - 로그인된 사용자가 회원가입 페이지에 접근하면 자동으로 메인 페이지로 리다이렉트

- **사용자 정보 표시**
  - 로그인된 사용자의 이메일(또는 프로필 정보)을 상단 영역에 표시

- **로그아웃 처리**
  - 로그아웃 시 세션이 즉시 해제되고 로그인 페이지로 이동

- **상태 변화 실시간 반영**
  - 로그인/로그아웃 상태 변화 실시간 감지 및 반영

### 2. 구현 조건
- 전체 레이아웃(app/layout.tsx) 또는 상단 헤더 컴포넌트에서 인증 상태 확인
- 화면 스타일은 유지, 기능 구현을 위한 최소한의 수정만 허용

## 결과

다음 파일들을 수정:
- `app/page.tsx`: 메인 페이지 세션 확인 및 사용자 정보 표시 (이미 완료)
- `app/login/page.tsx`: 이미 로그인된 사용자 리다이렉트 추가
- `app/signup/page.tsx`: 이미 로그인된 사용자 리다이렉트 추가
- `prompt/프롬프트_20260109_인증상태관리.md`: 프롬프트 파일
- `개발일지/20260109_인증상태관리.md`: 개발일지

### 주요 변경사항

**app/page.tsx (이미 구현됨)**
1. `useEffect`로 세션 확인
2. 비로그인 사용자 `/login`으로 리다이렉트
3. `onAuthStateChange`로 인증 상태 변경 감지
4. 실제 사용자 이메일 표시
5. 로그아웃 기능 연동

**app/login/page.tsx**
1. `useEffect` 추가
2. 세션 확인 로직 구현
3. 이미 로그인된 사용자 `/`로 리다이렉트
4. `isChecking` 상태로 로딩 화면 표시

**app/signup/page.tsx**
1. `useEffect` 추가
2. 세션 확인 로직 구현
3. 이미 로그인된 사용자 `/`로 리다이렉트
4. `isChecking` 상태로 로딩 화면 표시

## 특이사항

### 인증 흐름

**비로그인 사용자**:
1. `/` 접근 → `/login`으로 리다이렉트
2. 로그인 성공 → `/`로 이동

**로그인된 사용자**:
1. `/login` 또는 `/signup` 접근 → `/`로 리다이렉트
2. 메인 페이지에서 사용자 정보 표시
3. 로그아웃 → 세션 제거 → `/login`으로 이동

### 실시간 상태 변화 감지

`onAuthStateChange`를 사용하여 인증 상태 변화를 실시간으로 감지:
- 로그인 시 자동으로 사용자 정보 업데이트
- 로그아웃 시 자동으로 로그인 페이지로 리다이렉트
- 다른 탭에서 로그인/로그아웃 시에도 동기화

### 로딩 상태 처리

모든 페이지에서 세션 확인 중 로딩 화면 표시:
- 깜빡임 방지
- 사용자 경험 개선
- 일관된 디자인
